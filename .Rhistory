Female <- ts(data=my_data, start=1965)
ts.plot(Female)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 17), col="red")
Female <- ts(data=my_data, start=1965, end=1985)
ts.plot(Female)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 17), col="red")
Female <- ts(data=my_data)
ts.plot(Female)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 17), col="red")
lines(mav(Female, 17), col="red")
arima(Female)
arima(x=Female)
auto.arima(Female)
library(forecast)
install.packages('forecast')
library(forecast)
library('forecast')
auto.arima(Female)
Arima(Female)
auto.arima(Female)
auto.arima(Female)
library(forecast)
require(forecast)
forecast::auto.arima(Female)
install.packages("forecast")
library(forecast)
library("forecast")
forecast::auto.arima(Female)
install.packages("forecast")
library(forecast)
par(mfrow = c(1,1))
my_data <- read.delim("female.txt")
Female <- ts(data=my_data)
ts.plot(Female)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 17), col="red")
forecast::auto.arima(Female)
install.packages("forecast")
install.packages("RcppArmadillo")
install.packages("forecast")
arima(Female)
arima(Female, order=c(0,1,1))
lines(mav(Female, 17), col="red")
Female <- ts(data=my_data)
ts.plot(Female)
# Definicja funkcji dla średniej ruchomej
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
# Średnia ruchoma rzędu 17
lines(mav(Female, 17), col="red")
library(forecast)
install.packages("forecast")
library(forecast)
install.packages("forecast")
install.packages("https://cran.r-project.org/src/contrib/Archive/RcppArmadillo/RcppArmadillo_0.6.100.0.0.tar.gz", repos=NULL, type="source")
install.packages("forecast")
library(forecast)
auto.arima(Female)
arima(Female)
Arima(Female)
auto.a
auto.arima(Female)
plot(forecast(auto.arima(Female),h=20))
plot(forecast(auto.arima(Female),h=17))
auto.arima(auto.arima(Female))
auto.arima(Female)
ts.plot(Female)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 17), col="red")
auto.arima(Female)
unemp_data <- read.delim("unemp.txt")
View(unemp_data)
unemp.ts M- ts(data=unemp_data)
unemp.ts <- ts(data=unemp_data)
unemp.ts <- ts(data=unemp_data, deltat=1/12)
ts.plot(unemp.ts)
unemp.ts <- ts(data=unemp_data, deltat=1/12, time(1975, 1979))
ts.plot(unemp.ts)
unemp.ts <- ts(data=unemp_data, deltat=1/12, time(1975))
ts.plot(unemp.ts)
unemp.ts <- ts(data=unemp_data, deltat=1/12, time(1975:1979))
ts.plot(unemp.ts)
date.start <- as.Date("1975-07-01", tz="UTC")
date.end <- as.Date("1979-09-01", tz="UTC")
unemp.ts <- ts(data=unemp_data, deltat=1/12, time(c(date.start:date.end)))
ts.plot(unemp.ts)
unemp.ts <- ts(data=unemp_data, deltat=1/12, time(c(date.start:date.end)))
ts.plot(unemp.ts)
unemp.ts <- ts(data=unemp_data, deltat=1/12, time(c(date.start,date.end)))
ts.plot(unemp.ts)
unemp.ts <- ts(data=unemp_data, deltat=1/12, time(date.start))
date.end <- as.Date("1979-09-01", tz="UTC")
unemp.ts <- ts(data=unemp_data, deltat=1/12, time(date.start:date.end))
ts.plot(unemp.ts)
unemp.ts <- ts(data=unemp_data, deltat=1/12, time(date.start,date.end))
ts.plot(unemp.ts)
unemp.ts <- ts(data=unemp_data, start = c(1975, 7), end = c(1979, 9))
ts.plot(unemp.ts)
unemp.ts <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
ts.plot(unemp.ts)
Female <- ts(data=my_dat, start = c(1961, 7), frequency = 12a)
ts.plot(Female)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 17), col="red")
auto.arima(Female) # Tutaj brakuje coefficients
Female <- ts(data=my_dat, start = c(1961, 7), frequency = 12)
ts.plot(Female)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 17), col="red")
auto.arima(Female) # Tutaj brakuje coefficients
unemp_data <- read.delim("unemp.txt")
unemp.ts <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
ts.plot(unemp.ts)
mav.12 <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav.12(Female, 12), col="red")
lines(mav.12(unemp.ts, 12), col="red")
grid()
model.hw <- HoltWinters(unemp.ts)
lines(model.hw, col="blue")
lines(forecast(model.hw), col="blue")
lines(forecast(model.hw, h=12), col="blue")
plot(model.hw)
plot(model.hw, col="blue")
autoplot(unemp_data)
library(ggplot2)
autoplot(unemp_data)
unemp_data <- read.delim("unemp.txt")
autoplot(unemp_data)
filter(unemp_data, rep(1 / 3, 3))
model.hw <- HoltWinters(unemp_data)
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
autoplot(unemp)
filter(unemp, rep(1 / 3, 3))
model.hw <- HoltWinters(unemp)
autoplot(forecast(model.hw, h = 12))
plot(model.hw)
lines(filter(AirPassengers, rep(1 / 3, 3)), col = 'blue')
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
autoplot(unemp)
filter(unemp, rep(1 / 3, 3))
auto.model <- auto.arima(model.hw)
summary(auto.model)
auto.model <- auto.arima(unemp)
summary(auto.model)
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
autoplot(unemp)
autoplot(unemp)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(unemp, 12), col="red")
lines(mav(unemp, 12), col="red")
plot(unemp)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(unemp, 12), col="red")
filter(unemp, rep(1 / 3, 3))
model.hw <- HoltWinters(unemp)
lines(model.hw, col="blue")
model.hw <- HoltWinters(unemp)
lines(filter(model.hw, rep(1 / 3, 3), col="blue")
model.hw <- HoltWinters(unemp)
lines(filter(model.hw, rep(1 / 3, 3), col="blue"))
lines(filter(model.hw, rep(1 / 3, 3)), col="blue")
filter(unemp, rep(1 / 3, 3))
model.hw <- HoltWinters(unemp)
lines(filter(model.hw, rep(1 / 3, 3)), col="blue")
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(unemp, 12), col="red")
filter(unemp, rep(1 / 3, 3))
model.hw <- HoltWinters(unemp)
lines(filter(model.hw, rep(1 / 3, 3)), col="blue")
plot(model.hw)
lines(filter(model.hw, rep(1 / 3, 3)), col="blue")
lines(model.hw, col="blue")
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(unemp, 12), col="red")
model.hw <- HoltWinters(unemp)
lines(model.hw)
lines(mav(unemp, 12), col="red")
filter(model.hw, rep(1 / 3, 3))
model.hw <- HoltWinters(unemp)
plot(model.hw)
lines(model.hw)
lines(filter(unemp, rep(1 / 3, 3)), col = 'blue')
plot(model.hw, col="blue")
lines(mav(unemp, 12), col="red")
plot(model.hw, col="black")
lines(mav(unemp, 12), col="red")
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
filter(model.hw, rep(1 / 3, 3))
model.hw <- HoltWinters(unemp)
plot(model.hw, col="black")
plot(model.hw, col="blue")
lines(mav(unemp, 12), col="red")
filter(model.hw, rep(1 / 3, 3))
model.hw <- HoltWinters(unemp)
plot(model.hw, col="blue")
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
filter(model.hw, rep(1 / 3, 3))
model.hw <- HoltWinters(unemp)
lines(model.hw)
lines(filter(unemp, rep(1 / 3, 3)), col = 'blue')
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
lines(filter(unemp, rep(1 / 3, 3)), col = 'blue')
lines(unemp, col = 'blue')
plot(unemp)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 12), col="red")
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 12), col="red")
plot(unemp)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 12), col="red")
lines(mav(unemp, 12), col="red")
model.lw <- HoltWinters(unemp)
model.lw
model.lw$SSE
plot(model.lw)
lines(mav(unemp, 12), col="red")
plot(model.lw, col = blue)
plot(model.lw, col = "blue")
plot(model.lw)
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
model.lw <- HoltWinters(unemp)
plot(model.lw)
lines(mav(unemp, 12), col="red")
lines(mav(unemp, 12), col="blue")
auto.model <- auto.arima(model.lw)
auto.model <- auto.arima(unemp)
summary(auto.model)
(unemp)
plot(unemp)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
model.lw <- HoltWinters(unemp)
plot(model.lw)
lines(mav(unemp, 12), col="blue")
auto.model <- auto.arima(unemp)
summary(auto.model)
auto.model <- auto.arima(HoltWinters)
summary(auto.model)
auto.model <- auto.arima(model.lw)
auto.model <- auto.arima(unemp)
summary(auto.model)
Female <- ts(data=my_dat, start = c(1961, 7), frequency = 12)
ts.plot(Female)
par(mfrow = c(1,1))
my_data <- read.delim("female.txt")
Female <- ts(data=my_dat, start = c(1961, 7), frequency = 12)
ts.plot(Female)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
library(forecast)
par(mfrow = c(1,1))
my_data <- read.delim("female.txt")
Female <- ts(data=my_dat, start = c(1961, 7), frequency = 12)
Female <- ts(data=my_data, start = c(1961, 7), frequency = 12)
ts.plot(Female)
mav <- function(x,n=5){stats::filter(x,rep(1/n,n), sides=2)}
lines(mav(Female, 17), col="red")
auto.model <- auto.arima(unemp)
auto.model <- auto.arima(Female)
summary(auto.model)
ma(Female)
ma(Female, order=17)
library(forecast)
par(mfrow = c(1,1))
my_data <- read.delim("female.txt")
Female <- ts(data=my_data, start = c(1961, 7), frequency = 12)
ts.plot(Female)
lines(ma(Female, order=17), col="red")
auto.model <- auto.arima(Female)
summary(auto.model)
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
lines(ma(unemp, order=12), col="red")
model.lw <- HoltWinters(unemp)
lines(model.lw)
lines(filter(AirPassengers, rep(1 / 3, 3)), col = 'blue')
lines(filter(unemp, rep(1 / 3, 3)), col = 'blue')
lines(unemp, col = 'blue')
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
lines(ma(unemp, order=12), col="red")
model.lw <- HoltWinters(unemp)
lines(unemp, col = 'blue')
auto.model <- auto.arima(unemp)
plot(model.hw)
auto.model <- auto.arima(unemp)
summary(auto.model)
model.lw <- HoltWinters(unemp)
lines(unemp, col = 'blue')
plot(model.hw)
model.hw <- HoltWinters(unemp)
lines(unemp, col = 'blue')
plot(model.hw)
auto.model <- auto.arima(unemp)
summary(auto.model)
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
lines(ma(unemp, order=12), col="red")
model.hw <- HoltWinters(unemp)
model.hw <- HoltWinters(unemp, beta=FALSE)
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
lines(ma(unemp, order=12), col="red")
model.hw <- HoltWinters(unemp, beta=FALSE)
lines(model.hw)
plot(model.hw)
plot(unemp)
lines(ma(unemp, order=12), col="red")
plot(model.hw)
plot(model.hw, col = "blue solid")
plot(model.hw, col = "blue")
plot(model.hw)
autoplot(model.hw)
plot(model.hw, col = "blue")
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
lines(ma(unemp, order=12), col="red")
model.hw <- HoltWinters(unemp, beta=FALSE)
plot(model.hw, col = "blue", col.predicted = "red")
plot(model.hw, , col.predicted = "red")
plot(model.hw, col.predicted = "red")
plot(model.hw, col.predicted = "blue")
lines(ma(Female, order=12), col="red")
lines(ma(unemp, order=12), col="red")
plot(unemp)
model.hw <- HoltWinters(unemp, beta=FALSE)
lines(model.hw, col.predicted = "blue")
lines(ma(unemp, order=12), col="red")
lines(model.hw$x, col.predicted = "blue")
lines(model.hw$x, col = "blue")
plot(unemp)
lines(model.hw$x)
model.hw <- HoltWinters(unemp, beta=FALSE)
lines(model.hw$x)
lines(ma(unemp, order=12), col="red")
, col = "blue"
plot(model.hw, col.predicted = "blue")
lines(ma(unemp, order=12), col="red")
plot(model.hw, col.predicted = "blue",start = c(1975, 7))
plot(model.hw, col.predicted = "blue")
lines(ma(unemp, order=12), col="red")
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
model.hw <- HoltWinters(unemp, beta=FALSE)
plot(model.hw, col.predicted = "blue")
plot(unemp)
model.hw <- HoltWinters(unemp, beta=FALSE)
lines(ma(unemp, order=12), col="red")
lines(model.hw$fitted, col.predicted = "blue")
model.hw
lines(model.hw, col.predicted = "blue")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
model.hw <- HoltWinters(unemp, beta=FALSE)
plot(model.hw, col.predicted = "blue")
lines(ma(unemp, order=12), col="red")
plot(unemp)
lines(ma(unemp, order=12), col="red")
model.hw <- HoltWinters(unemp, beta=FALSE)
par(new=TRUE)
plot(model.hw, col.predicted = "blue")
plot(unemp)
lines(ma(unemp, order=12), col="red")
model.hw <- HoltWinters(unemp, beta=FALSE)
plot(model.hw, col.predicted = "blue")
lines(model.hw$x, model.hw$fitted)
lines(x=model.hw$x, y=model.hw$fitted)
lines(model.hw$x)
plot(unemp)
lines(model.hw$x)
lines(ma(unemp, order=12), col="red")
lines(model.hw)
lines(model.hw$fitted)
lines(model.hw$alpha)
lines(model.hw$beta)
lines(model.hw$SSE)
unemp_data <- read.delim("unemp.txt")
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
lines(ma(unemp, order=12), col="red")
model.hw <- HoltWinters(unemp, beta=FALSE)
plot(model.hw)
plot(unemp)
lines(ma(unemp, order=12), col="red")
lines(HoltWinters(unemp, beta=FALSE)$fitted[,2], col = "red")
lines(HoltWinters(unemp, beta=FALSE)$x, col = "red")
plot(unemp)
lines(ma(unemp, order=12), col="red")
lines(HoltWinters(unemp, beta=FALSE)$fitted[,1], col = "red")
lines(HoltWinters(unemp, beta=FALSE)$fitted[,1], col = "blue")
auto.model <- auto.arima(Female)
summary(auto.model)
auto.model <- auto.arima(unemp)
summary(auto.model)
auto.model <- auto.arima(filter(unemp, rep(1 / 3, 3)))
summary(auto.model)
auto.model <- auto.arima(unemp)
summary(auto.model)
auto.model <- auto.arima(HoltWinters(unemp))
unemp
auto.model <- auto.arima(unemp)
summary(auto.model)
abs(polyroot(c(1, -1/2)))
abs(polyroot(c(1,5, -1/2)))
abs(polyroot(c(1.5, -1/2)))
abs(polyroot(c(3/2, -1/2)))
abs(polyroot(c(5/6, -1/6)))
abs(polyroot(c(1, -3/2, 1/2)))
abs(polyroot(c(1, -5/6, 1/6))) # nie jest stacjonarny - pierwiastki 1 i 2
abs(polyroot(c(1, -2/3, 5/3))) # jest stacjonarny - pierwiastki 2 i 3
library(forecast)
par(mfrow = c(1,1))
my_data <- read.delim("female.txt", header=FALSE)
Female <- ts(data=my_data, start = c(1961, 7), frequency = 12)
ts.plot(Female)
lines(ma(Female, order=17), col="red")
auto.model <- auto.arima(Female)
summary(auto.model)
unemp_data <- read.delim("unemp.txt", header=FALSE)
unemp <- ts(data=unemp_data, start = c(1975, 7), frequency = 12)
plot(unemp)
lines(ma(unemp, order=12), col="red")
lines(HoltWinters(unemp, beta=FALSE)$fitted[,1], col = "blue")
auto.model <- auto.arima(unemp)
summary(auto.model)
library("MASS")
painters
var(painters)
painters.pca <- prcomp(painters, scale = TRUE)
painters
diag(var(data.set[, 1:4]))
data.set <- MASS::painters
diag(var(data.set[, 1:4]))
model.pca <- prcomp(data.set[, 1:4])
plot(model.pca)
summary(model.pca)
library(dplyr)
library("ggplot2")
#pierwsz dwie wyjasniaja 84% wiec mozna by sie do nich ogranbiczyc
#3 pierwsze najlepsze wyjasniaja az 93 %
cbind(data.frame(model.pca$x), School = data.set(School)) %>%
as_tibble() %>%
ggplot(aes(x = PC1, y = PC2, col = School, label = rownames(.))) +
geom_text()
data.set <- MASS::painters
diag(var(data.set[, 1:4]))
model.pca <- prcomp(data.set[, 1:4])
plot(model.pca)
summary(model.pca)
#pierwsz dwie wyjasniaja 84% wiec mozna by sie do nich ogranbiczyc
#3 pierwsze najlepsze wyjasniaja az 93 %
cbind(data.frame(model.pca$x), School = data.set(School)) %>%
as_tibble() %>%
ggplot(aes(x = PC1, y = PC2, col = School, label = rownames(.))) +
geom_text()
#pierwsz dwie wyjasniaja 84% wiec mozna by sie do nich ogranbiczyc
#3 pierwsze najlepsze wyjasniaja az 93 %
cbind(data.frame(model.pca$x), School = data.set$School) %>%
as_tibble() %>%
ggplot(aes(x = PC1, y = PC2, col = School, label = rownames(.))) +
geom_text()
data.cars <- MASS::Cars93
new.data %>%  #dalej nie zadążyłem na ten moment
ggplot(aes(x = PC1, y = PC2, col = Origin, label = Model)) +
geom_text() -> p1
data.cars <- MASS::Cars93[-c(19,57), c(4:8, 12:15, 17:23,25)]
ds.Origin <- tibble(Origin = MASS::Cars93$Origin[-c(19,57)])
ds.Type <- tibble(Type = MASS::Cars93$Type[-c(19,57)])
ds.Model <- tibble(Model = MASS::Cars93$Model[-c(19,57)])
prcomp(data.cars, scale. = TRUE)$x %>%
as_tibble() %>%
select(PC1, PC2) %>%
bind_cols(ds.Origin, ds.Type, ds.Model) -> new.data
new.data %>%  #dalej nie zadążyłem na ten moment
ggplot(aes(x = PC1, y = PC2, col = Origin, label = Model)) +
geom_text() -> p1
library(gridExtra)
grid.arrange(p1,
p2,
ncol = 2)
new.data %>%  #dalej nie zadążyłem na ten moment
ggplot(aes(x = PC1, y = PC2, col = Type, label = Model)) +
geom_text() -> p2
library(gridExtra)
grid.arrange(p1,
p2,
ncol = 2)
