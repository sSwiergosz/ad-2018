library(drc)
install.packages(drc)
install.packages("drc")
library(drc)
install.packages("drc")
library(drc)
library(drc)
heartrate.lr = <- nls(pressure ~ SSlogis(rate , a , b , c), data = heartrate)
heartrate.lr <- nls(pressure ~ SSlogis(rate , a , b , c), data = heartrate)
broom::tidy(heartrate.lr)
install.packages("broom")
broom::tidy(heartrate.lr)
ggplot(USPop,aes( x =  year, y = population)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
library(ggplot2)
ggplot(USPop,aes( x =  year, y = population)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
ggplot(USPop,aes( x =  year, y = population)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
ggplot(heartrate,aes( x =  pressure, y = rate)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
heartrate.lr <- nls(rate ~ SSlogis(pressure , a , b , c), data = heartrate)
broom::tidy(heartrate.lr)
ggplot(heartrate,aes( x =  rate, y = pressure)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
heartrate.lr <- nls(rate ~ SSasymp(pressure , a , b , c), data = heartrate)
broom::tidy(heartrate.lr)
ggplot(heartrate,aes( x =  rate, y = pressure)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
heartrate.lr <- nls(rate ~ SSasymp(pressure , a , b , c), data = heartrate)
broom::tidy(heartrate.lr)
ggplot(heartrate,aes( x =  rate, y = pressure)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
heartrate.lr <- nls(rate ~ SSasympOff(pressure , a , b , c), data = heartrate)
broom::tidy(heartrate.lr)
ggplot(heartrate,aes( x =  rate, y = pressure)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
pop.ss <- nls(population ~ SSlogis(year, a, b, c), data=USPop)
summary(pop.ss)
broom::tidy(pop.ss)
ggplot(USPop,aes( x =  year, y = population)) +
geom_point() +
stat_function(fun = function(x) coef(pop.ss)[1]/( 1 + exp((coef(pop.ss)[2] - x)/ coef(pop.ss)[3])), col = 'red')
library(carData)
pop.ss <- nls(population ~ SSlogis(year, a, b, c), data=USPop)
library(carData)
pop.ss <- nls(population ~ SSlogis(year, a, b, c), data=USPop)
pop.ss <- nls(population ~ SSlogis(year, a, b, c), data=USPop)
summary(pop.ss)
broom::tidy(pop.ss)
ggplot(USPop,aes( x =  year, y = population)) +
geom_point() +
stat_function(fun = function(x) coef(pop.ss)[1]/( 1 + exp((coef(pop.ss)[2] - x)/ coef(pop.ss)[3])), col = 'red')
heartrate.lr <- nls(rate ~ SSasympOff(pressure , a , b , c), data = heartrate)
heartrate.lr <- nls(rate ~ SSasympOff(pressure , a , b , c), data = heartrate)
heartrate.lr <- nls(rate ~ SSasympOff(pressure , a , b , c), data = heartrate)
library(drc)
library(ggplot2)
heartrate.lr <- nls(rate ~ SSasympOff(pressure , a , b , c), data = heartrate)
heartrate.lr <- nls(rate ~ SSlogis(pressure , a , b , c), data = heartrate)
broom::tidy(heartrate.lr)
ggplot(heartrate,aes( x =  rate, y = pressure)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
heartrate.lr <- nls(rate ~ SSbiexp(pressure , a , b , c), data = heartrate)
library(ggplot2)
heartrate.lr <- nls(rate ~ SSbiexp(pressure , a , b , c), data = heartrate)
broom::tidy(heartrate.lr)
ggplot(heartrate,aes( x =  rate, y = pressure)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
library(ggplot2)
heartrate.lr <- nls(pressure ~ SSbiexp(rate , a , b , c), data = heartrate)
heartrate.lr <- nls(pressure ~ SSlogis(rate , a , b , c), data = heartrate)
broom::tidy(heartrate.lr)
ggplot(heartrate,aes( x =  rate, y = pressure)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
heartrate.lr <- nls(pressure ~ SSlogis(rate , a , b , c), data = heartrate)
broom::tidy(heartrate.lr)
ggplot(heartrate,aes( x =  rate, y = pressure)) +
geom_point() +
stat_function(fun = function(x) coef(heartrate.lr)[1]/( 1 + exp((coef(heartrate.lr)[2] - x)/ coef(heartrate.lr)[3])), col = 'red')
require(reshape2)
df <- melt(data.frame(v,t))
colnames(df) <- c(v_name,y_name)
print(df)
colnames(df) <- c(v_name,y_name)
v_name <- "speed"
y_name <- "time"
v <- c(0,10, 16.3, 23, 27.5, 31, 35.6, 39, 41.5, 42.9, 45, 46,
45.5, 46, 49, 50)
t <- c(0:length(v))
v_name <- "speed"
y_name <- "time"
require(reshape2)
df <- melt(data.frame(v,t))
colnames(df) <- c(v_name,y_name)
print(df)
print(df)
v <- c(0,10, 16.3, 23, 27.5, 31, 35.6, 39, 41.5, 42.9, 45, 46,
45.5, 46, 49, 50)
t <- c(0:length(v))
v_name <- "speed"
y_name <- "time"
require(reshape2)
df <- melt(data.frame(v,t))
v <- c(0,10, 16.3, 23, 27.5, 31, 35.6, 39, 41.5, 42.9, 45, 46,
45.5, 46, 49, 50)
t <- c(0:(length(v) - 1)
t <- c(0:(length(v) - 1))
v_name <- "speed"
y_name <- "time"
require(reshape2)
df <- melt(data.frame(v,t))
colnames(df) <- c(v_name,y_name)
print(df)
t <- c(0:(length(v) - 1))
v <- c(0,10, 16.3, 23, 27.5, 31, 35.6, 39, 41.5, 42.9, 45, 46,
45.5, 46, 49, 50)
t <- c(0:(length(v) - 1))
length(v)
length(t)
v_name <- "speed"
y_name <- "time"
require(reshape2)
df <- melt(data.frame(v,t))
colnames(df) <- c(v_name,y_name)
print(df)
t
df <- data.frame(v,t)
colnames(df) <- c(v_name,y_name)
print(df)
ggplot(df.md, aes(speed, time)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1] * x / coef(df.md)[2] + x)
df.md = nls(speed ~ SSmicmen(time, a, b))
df.md = nls(speed ~ SSmicmen(time, a, b), data = df)
df.md = nls(speed ~ SSmicmen(time, a, b), data = df)
broom::tidy(df.md)
v <- c(10, 16.3, 23, 27.5, 31, 35.6, 39, 41.5, 42.9, 45, 46,
45.5, 46, 49, 50)
t <- c(1:(length(v) - 1))
length(v)
t
v_name <- "speed"
y_name <- "time"
require(reshape2)
df <- data.frame(v,t)
v <- c(10, 16.3, 23, 27.5, 31, 35.6, 39, 41.5, 42.9, 45, 46,
45.5, 46, 49, 50)
t <- c(1:(length(v)))
length(v)
t
v_name <- "speed"
y_name <- "time"
require(reshape2)
df <- data.frame(v,t)
colnames(df) <- c(v_name,y_name)
print(df)
df.md = nls(speed ~ SSmicmen(time, a, b), data = df)
broom::tidy(df.md)
ggplot(df.md, aes(speed, time)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1] * x / coef(df.md)[2] + x)
ggplot(df, aes(speed, time)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1] * x / coef(df.md)[2] + x)
ggplot(df, aes(speed, time)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1] * x / coef(df.md)[3] + x)
df.md = nls(speed ~ SSlogis(time, a, b, c), data = df)
broom::tidy(df.md)
ggplot(df, aes(speed, time)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1]/( 1 + exp((coef(df.md)[2] - x)/ coef(df.md)[3])), col = 'red')
v <- c(10, 16.3, 23, 27.5, 31, 35.6, 39, 41.5, 42.9, 45, 46,
45.5, 46, 49, 50)
t <- c(1:(length(v)))
length(v)
t
v_name <- "speed"
y_name <- "time"
require(reshape2)
df <- data.frame(v,t)
colnames(df) <- c(v_name,y_name)
print(df)
df.md = nls(speed ~ SSlogis(time, a, b, c), data = df)
broom::tidy(df.md)
ggplot(df, aes(speed, time)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1]/( 1 + exp((coef(df.md)[2] - x)/ coef(df.md)[3])), col = 'red')
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1]/( 1 + exp((coef(df.md)[2] - x)/ coef(df.md)[3])), col = 'red')
v <- c(10, 16.3, 23, 27.5, 31, 35.6, 39, 41.5, 42.9, 45, 46,
45.5, 46, 49, 50)
t <- c(1:(length(v)))
length(v)
t
v_name <- "speed"
y_name <- "time"
require(reshape2)
df <- data.frame(v,t)
colnames(df) <- c(v_name,y_name)
print(df)
df.md = nls(speed ~ SSlogis(time, a, b, c), data = df)
broom::tidy(df.md)
predict(df.md, new_data = data.frame(time = 18))
View(df)
data.frame(time = 18)
predict(df.md, new_data = data.frame(time = 18))
predict(df.md, new_data = data.frame(time = 18))
predict(df.md)
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1]/( 1 + exp((coef(df.md)[2] - x)/ coef(df.md)[3])), col = 'red')
predict(df.md)
, new_data = data.frame(time = 18)
predict(df.md, new_data = data.frame(time = 18))
predict(df.md, new_data = data.frame(seq(1,20)))
predict(df.md, new_data = data.frame(seq(1,20)))
predict(df.md, new_data = data.frame(seq(1,20)))
predict(df.md)
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1]/( 1 + exp((coef(df.md)[2] - x)/ coef(df.md)[3])), col = 'red')
predict(df.md)
predict.nls(df.md)
predict.lm(df.md)
predict.lm(df.md, new_data = data.frame(time = 18))
predict.nls(df.md, new_data = data.frame(time = 18))
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1]/( 1 + exp((coef(df.md)[2] - x)/ coef(df.md)[3])), col = 'red')
library(ggplot2)
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1]/( 1 + exp((coef(df.md)[2] - x)/ coef(df.md)[3])), col = 'red')
predict.nls(df.md, new_data = data.frame(time = 18))
predict.glm(df.md, new_data = data.frame(time = 18))
predict.lm(df.md, new_data = data.frame(time = 18))
predict(df.md, new_data = data.frame(time = 18))
predict(df.md, new_data = data.frame(time = 500))
df.md = lm(speed ~ time, data = df)
predict(df.md, new_data = data.frame(time = 18))
predict(df.md, new_data = data.frame(time = 18))
predict(df.md, new_data = data.frame(time = ))
df <- data.frame(v,t)
colnames(df) <- c(v_name,y_name)
print(df)
df.md = lm(speed ~ time, data = df)
predict(df.md, new_data = data.frame(time = ))
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1]/( 1 + exp((coef(df.md)[2] - x)/ coef(df.md)[3])), col = 'red')
df.md = nls(speed ~ SSmicmen(time, a, b), data = df)
broom::tidy(df.md)
data.frame(time = 18)
predict(df.md, new_data = data.frame(time = 500))
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1]/( 1 + exp((coef(df.md)[2] - x)/ coef(df.md)[3])), col = 'red')
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) coef(df.md)[1] * x/(exp((coef(df.md)[2] + x))), col = 'red')
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) (coef(df.md)[1] * x)/(exp((coef(df.md)[2] + x))), col = 'red')
df.md = nls(speed ~ SSmicmen(time, a, b), data = df)
broom::tidy(df.md)
data.frame(time = 18)
predict(df.md, new_data = data.frame(time = 500))
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) (coef(df.md)[1] * x)/(exp((coef(df.md)[2] + x))), col = 'red')
broom::tidy(df.md)
df.md = nls(speed ~ SSmicmen(time, a, b), data = df)
data.frame(time = 18)
predict(df.md, new_data = data.frame(time = 500))
ggplot(df, aes(time, speed)) +
geom_point() +
stat_function(fun = function(x) (coef(df.md)[1] * x)/(exp((coef(df.md)[2] + x))), col = 'red')
predict(df.md, new_data = data.frame(time = 500))
ggplot(df, aes( x = time, y =speed)) +
geom_point() +
stat_function(fun = function(x) (coef(df.md)[1] * x)/(exp((coef(df.md)[2] + x))), col = 'red')
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
stat_function(fun = function(x) (coef(df.md)[1] * x)/(exp((coef(df.md)[2] + x))), col = 'red')
df.md
df.md[1]
coef(df.md)[1]
coef(df.md)[2]
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
stat_function(fun = function(x) (coef(df.md)[1] * x)/((coef(df.md)[2] + x)), col = 'red')
predict(df.md, new_data = data.frame(time = 18))
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
geom_point(18)
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
geom_point(aes(18))
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
geom_point(aes(18)) +
stat_function(fun = function(x) (coef(df.md)[1] * x)/((coef(df.md)[2] + x)), col = 'red')
geom_point(aes(18), (coef(df.md)[1] * 18)/((coef(df.md)[2] + 18)) +
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
geom_point( aes(18), (coef(df.md)[1] * 18)/((coef(df.md)[2] + 18))) +
stat_function(fun = function(x) (coef(df.md)[1] * x)/((coef(df.md)[2] + x)), col = 'red')
coef(df.md)[2]
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
geom_point( aes(18), (coef(df.md)[1] * 18)/((coef(df.md)[2] + 18))) +
stat_function(fun = function(x) (coef(df.md)[1] * x)/((coef(df.md)[2] + x)), col = 'red')
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
geom_point( aes(18), (coef(df.md)[1] * 18)/((coef(df.md)[2] + 18))) #+
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
geom_point(aes(18, (coef(df.md)[1] * 18)/((coef(df.md)[2] + 18)))) #+
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
geom_point(aes(18, (coef(df.md)[1] * 18)/((coef(df.md)[2] + 18)))) +
stat_function(fun = function(x) (coef(df.md)[1] * x)/((coef(df.md)[2] + x)), col = 'red')
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
geom_point(aes(18, (coef(df.md)[1] * 18)/((coef(df.md)[2] + 18))) , col = blue) +
stat_function(fun = function(x) (coef(df.md)[1] * x)/((coef(df.md)[2] + x)), col = 'red')
ggplot(df, aes( x = df$time, y =speed)) +
geom_point() +
geom_point(aes(18, (coef(df.md)[1] * 18)/((coef(df.md)[2] + 18))) , col = 'blue') +
stat_function(fun = function(x) (coef(df.md)[1] * x)/((coef(df.md)[2] + x)), col = 'red')
#zad1
'''
rats1 <- c(143, 165,
188, 188, 190, 192, 206, 208, 212, 216, 220, 227, 230, 235, 246, 265, 303,
216+, 244+)
rats2 <- c(142, 157, 163, 198, 205, 232, 232, 232, 233, 233, 233,
233, 239, 240, 261, 280, 280, 295, 295, 323, 204+, 344+)
'''
library(survival)
library(survminer)
rats1 <- c(143, 165,
188, 188, 190, 192, 206, 208, 212, 216, 220, 227, 230, 235, 246, 265, 303,
216, 244)
rats2 <- c(142, 157, 163, 198, 205, 232, 232, 232, 233, 233, 233,
233, 239, 240, 261, 280, 280, 295, 295, 323, 204, 344)
allRats <- c(rats1,rats2)
rats1.cens <- Surv(rats1, c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0))
rats2.cens <- Surv(rats2, c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0))
allRats.cens <- Surv(allRats, c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0))
### MODELE OSBNE DLA GRUP ##
model.rats1 <- survfit(rats1.cens ~ 1 )
summary(model.rats1)
print(model.rats1, rmean = 'common')
model.rats2 <- survfit(rats2.cens ~ 1 )
summary(model.rats2)
print(model.rats2, rmean = 'common')
length(rats1.cens)
length(rats2.cens)
rats.data <- data.frame(grupa = c(rep("g1", times=length(rats1.cens)), rep("g2", times=length(rats2.cens))), czas_przezycia = allRats.cens)
rats.data
rats.model <- survfit(rats.data$czas_przezycia ~ rats.data$grupa)
summary(rats.model)
plot(rats.model,col = c("red","blue"))
ggsurvplot(rats.model,
data = rats.data,
risk.table = TRUE,
pval = TRUE,
conf.int = TRUE,
fun = 'pct',
legend.labs = c('Group1',
'Group2'),
legend.title = 'Rats')
#data.frame(result=c(rep("yes", times=length(yesFiles)), rep("no", times=length(noFiles))), name=c(yesFiles, noFiles))
#Zad 2
complete.cases(cancer)
str(cancer)
cancer.without.nas <- cancer[complete.cases(cancer),]
str(cancer.without.nas)
complete.cases(cancer.without.nas)
cancer.without.nas
cancer.without.nas$cens <- Surv(cancer.without.nas$time, status)
cancer.without.nas$cens <- Surv(cancer.without.nas$time, cancer.without.nas$status)
cancer.without.nas$cens
cancer.model <- survfit(formula = cens ~ sex, data = cancer.without.nas)
ggsurvplot(rats.model,
data = rats.data,
risk.table = TRUE,
pval = TRUE,
conf.int = TRUE,
fun = 'pct',
legend.labs = c('Group1',
'Group2'),
legend.title = 'Rats')
library(survival)
library(survminer)
install.packages(survminer)
install.packages("survminer")
ggsurvplot(cancer.model,
data = cancer.without.nas,
risk.table = TRUE,
pval = TRUE,
conf.int = TRUE,
fun = 'pct',
legend.labs = c('Male',
'Female'),
legend.title = 'Sex')
library(survminer)
ggsurvplot(cancer.model,
data = cancer.without.nas,
risk.table = TRUE,
pval = TRUE,
conf.int = TRUE,
fun = 'pct',
legend.labs = c('Male',
'Female'),
legend.title = 'Sex')
cancer.time.sex.surfdiff <- survdiff(formula = cens ~ sex, data = cancer.without.nas)
summary(cancer.time.sex.surfdiff)
cancer.time.sex.surfdiff
coxph(formula = time.c ~ sex + age + meal.cal, data = cancer.without.nas)
coxph(formula = cens ~ sex + age + meal.cal, data = cancer.without.nas)
AIC(cancer.without.nas, cens ~ sex + age + meal.cal)
AIC(cancer.model)
AIC(cancer.time.sex.surfdiff)
cancer.without.nas %>%
AIC(cens ~ sex + age + meal.cal )
cancer.without.nas %>%
AIC(cens ~ sex + age + meal.cal )
cancer.without.nas %>%
AIC(lm(cens ~ sex + age + meal.cal) )
cancer.without.nas %>%
mdl <- lm(cens ~ sex + age + meal.cal)
mdl <- lm(cens ~ sex + age + meal.cal, data = cancer.without.nas)
mdl <- lm(cens ~ sex + age + meal.cal, data = cancer.without.nas)
AIC(mdl)
extractAIC(cox)
cox <- coxph(formula = cens ~ sex + age + meal.cal, data = cancer.without.nas)
extractAIC(cox)
cox2 <- cox <- coxph(formula = cens ~ sex + age, data = cancer.without.nas)
cox2
cox
cox
cox <- coxph(formula = cens ~ sex + age + meal.cal, data = cancer.without.nas)
cox
library("MASS")
stepAIC(cancer.without.nas, cens ~ sex + age + meal.cal)
stepAIC(cancer.model)
